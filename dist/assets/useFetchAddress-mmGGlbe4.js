import{r as g,_ as o,P as n,b as _,j as e,a5 as q,a6 as F,a7 as C,e as S,a8 as $}from"./index-DCi0TphP.js";import{c as E,a as p}from"./index.esm-C25zvujW.js";const P=()=>{const[u,c]=g.useState(!1),s="http://35.154.167.170:3000",l=localStorage.getItem("token");return{addAddress:async r=>{var a;if(!l)return o.error("User is not authenticated!"),null;const d={...r,address_type:parseInt(r.address_type)};try{c(!0);const m=await fetch(`${s}/address`,{method:"POST",headers:{"Content-type":"application/json",Authorization:`Bearer ${l}`},body:JSON.stringify(d)}),t=await m.json();return m.ok?(o.success(t==null?void 0:t.message,{className:"toast-success"}),(a=t==null?void 0:t.data)==null?void 0:a.result):(o.error("Failed to add address!",{className:"toast-error"}),null)}catch{return o.error("Failed to add address!"),null}finally{c(!1)}},loading:u}},L=()=>{const[u,c]=g.useState(!1),s="http://35.154.167.170:3000",l=localStorage.getItem("token");return{loading:u,editAddress:async(r,d)=>{if(!l)return o.error("User is not authenticated!"),null;const a={...r,address_type:Number(r.address_type),pincode:String(r.pincode)};try{c(!0);const m=await fetch(`${s}/address/${d}`,{method:"PUT",headers:{"Content-type":"application/json",Authorization:`Bearer ${l}`},body:JSON.stringify(a)}),t=await m.json();return m.ok?(o.success(t.message),t):(o.error(t.message,{style:{maxWidth:"700px"}}),null)}catch{return o.error("Unable to update address"),null}finally{c(!1)}}}},R=E().shape({full_name:p().trim().min(6,"Full name must be at least 2 characters").max(50,"Full name cannot exceed 50 characters").required("Full name is required"),phone_number:p().matches(/^[0-9]{10}$/,"Phone number must be exactly 10 digits").required("Phone number is required"),address_type:p().required("Address type is require"),building_number:p().trim().required("Building number is required"),area:p().trim().required("Area is required"),landmark:p().trim().required("Landmark is required"),city:p().trim().required("City is required"),state:p().trim().required("State is required"),country:p().trim().required("Country is required"),pincode:p().matches(/^\d{6}$/,"Pincode must be exactly 6 digits").required("Pincode is required")}),U=({setIsOpen:u,isOpen:c,address:s,isEditMode:l})=>{const h=_(),{addAddress:r,loading:d}=P(),{editAddress:a,loading:m}=L(),[t,v]=g.useState({}),[i,y]=g.useState({full_name:"",phone_number:"",address_type:"1",building_number:"",area:"",landmark:"",pincode:"",city:"",state:"",country:""}),x=j=>{const{name:f,value:b}=j.target;y({...i,[f]:b})},A=async j=>{j.preventDefault();try{await R.validate(i,{abortEarly:!1})}catch(b){if(b.inner){const k={};b.inner.forEach(N=>{k[N.path]=N.message}),v(k)}return}if(l){const{address_id:b}=s;if(await a(i,b)){h(F({formData:i,address_id:b})),u(!1);return}}const f=await r(i);f&&(h(C(f)),u(!1))},w=()=>{u(!1),y({address_type:"1",full_name:"",phone_number:"",building_number:"",area:"",landmark:"",pincode:"",city:"",state:"",country:""})};return g.useEffect(()=>{s&&y({full_name:s.full_name,phone_number:s.phone_number,address_type:s.address_type,building_number:s.building_number,area:s.area,landmark:s.landmark,pincode:s.pincode,city:s.city,state:s.state,country:s.country})},[s]),e.jsx("section",{className:`fixed inset-0 overflow-y-auto px-8 py-10 bg-black bg-opacity-75 flex justify-center items-center z-50 ${c?"block":"hidden"}`,children:e.jsxs("div",{className:"w-[60rem] bg-white shadow-2xl px-12 py-12 pb-16 rounded-xl",children:[e.jsxs("div",{className:"mb-8 flex justify-between items-center",children:[e.jsx("h2",{className:"text-[2.4rem] leading-[2.4rem]",children:l?"Edit Address":"Add New Address"}),e.jsx(q,{className:"inline-block h-8 w-8 text-black cursor-pointer",onClick:w})]}),e.jsxs("form",{onSubmit:A,className:"grid grid-cols-[repeat(auto-fill,_minmax(20rem,_1fr))] w-full gap-x-10 gap-y-12",children:[e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("label",{htmlFor:"full_name",className:"self-start text-[1.2rem] text-[var(--black)]",children:"Fullname"}),e.jsx("input",{name:"full_name",id:"full_name",type:"text",onChange:x,value:i.full_name,className:"inline-block w-full p-3 ring-1 text-[1.2rem] rounded-lg text-[var(--black)"}),t.full_name&&e.jsx("p",{className:"text-lg text-[var(--secondary)] leading-[1]",children:t.full_name})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("label",{htmlFor:"phone_number",className:"self-start text-[1.2rem] text-[var(--black)]",children:"Phone number"}),e.jsx("input",{name:"phone_number",id:"phone_number",type:"text",onChange:x,value:i.phone_number,className:"inline-block w-full p-3 ring-1 text-[1.2rem] rounded-lg text-[var(--black)"}),t.phone_number&&e.jsx("p",{className:"text-lg text-[var(--secondary)] leading-[1]",children:t.phone_number})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("label",{htmlFor:"address_type",className:"self-start text-[1.2rem] text-[var(--black)]",children:"Address type"}),e.jsxs("select",{name:"address_type",id:"address_type",className:"inline-block w-full p-3 ring-1 text-[1.2rem] rounded-lg text-[var(--black)",onChange:x,defaultValue:1,children:[e.jsx("option",{value:1,children:"Home"}),e.jsx("option",{value:2,children:"Office"}),e.jsx("option",{value:3,children:"Other"})]}),t.address_type&&e.jsx("p",{className:"text-lg text-[var(--secondary)] leading-[1]",children:t.address_type})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("label",{htmlFor:"building_number",className:"self-start text-[1.2rem] text-[var(--black)]",children:"Building number"}),e.jsx("input",{name:"building_number",id:"building_number",type:"text",onChange:x,value:i.building_number,className:"inline-block w-full p-3 ring-1 text-[1.2rem] rounded-lg text-[var(--black)"}),t.building_number&&e.jsx("p",{className:"text-lg text-[var(--secondary)] leading-[1]",children:t.building_number})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("label",{htmlFor:"area",className:"self-start text-[1.2rem] text-[var(--black)]",children:"area"}),e.jsx("input",{name:"area",id:"area",type:"text",onChange:x,value:i.area,className:"inline-block w-full p-3 ring-1 text-[1.2rem] rounded-lg"}),t.area&&e.jsx("p",{className:"text-lg text-[var(--secondary)] leading-[1]",children:t.area})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("label",{htmlFor:"landmark",className:"self-start text-[1.2rem] text-[var(--black)]",children:"landmark"}),e.jsx("input",{name:"landmark",id:"landmark",type:"text",onChange:x,value:i.landmark,className:"inline-block w-full p-3 ring-1 text-[1.2rem] rounded-lg"}),t.landmark&&e.jsx("p",{className:"text-lg text-[var(--secondary)] leading-[1]",children:t.landmark})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("label",{htmlFor:"pincode",className:"self-start text-[1.2rem] text-[var(--black)]",children:"pincode"}),e.jsx("input",{name:"pincode",id:"pincode",type:"text",onChange:x,value:i.pincode,className:"inline-block w-full p-3 ring-1 text-[1.2rem] rounded-lg"}),t.pincode&&e.jsx("p",{className:"text-lg text-[var(--secondary)] leading-[1]",children:t.pincode})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("label",{htmlFor:"city",className:"self-start text-[1.2rem] text-[var(--black)]",children:"city"}),e.jsx("input",{name:"city",id:"city",type:"text",onChange:x,value:i.city,className:"inline-block w-full p-3 ring-1 text-[1.2rem] rounded-lg"}),t.city&&e.jsx("p",{className:"text-lg text-[var(--secondary)] leading-[1]",children:t.city})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("label",{htmlFor:"state",className:"self-start text-[1.2rem] text-[var(--black)]",children:"state"}),e.jsx("input",{name:"state",id:"state",type:"text",onChange:x,value:i.state,className:"inline-block w-full p-3 ring-1 text-[1.2rem] rounded-lg"}),t.state&&e.jsx("p",{className:"text-lg text-[var(--secondary)] leading-[1]",children:t.state})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("label",{htmlFor:"country",className:"self-start text-[1.2rem] text-[var(--black)]",children:"country"}),e.jsx("input",{name:"country",id:"country",type:"text",onChange:x,value:i.country,className:"inline-block w-full p-3 ring-1 text-[1.2rem] rounded-lg"}),t.country&&e.jsx("p",{className:"text-lg text-[var(--secondary)] leading-[1]",children:t.country})]}),e.jsx("div",{className:"flex justify-start items-end row-start-6",children:e.jsx("button",{type:"submit",className:"text-white bg-blue-700 text-[1.4rem] font-medium px-6 py-4 rounded-md flex gap-4 items-center",disabled:d||m,children:l?m?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"inline-block h-10 w-10 rounded-full border-4 border-t-white border-white/30 animate-spin"}),e.jsx("span",{children:"Processing..."})]}):"Edit Address":d?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"inline-block h-10 w-10 rounded-full border-4 border-t-white border-white/30 animate-spin"}),e.jsx("span",{children:"Processing..."})]}):"Add Address"})})]})]})})};U.propTypes={setIsOpen:n.func.isRequired,isOpen:n.bool.isRequired,address:n.shape({address_id:n.number,full_name:n.string,phone_number:n.string,address_type:n.number,building_number:n.string,area:n.string,landmark:n.string,pincode:n.number,city:n.string,state:n.string,country:n.string}),isEditMode:n.bool.isRequired};const T=()=>{const[u,c]=g.useState(!1),s="http://35.154.167.170:3000",l=localStorage.getItem("token");return{deleteAddress:async r=>{if(!r){o.error("Address Id is required to delete address");return}try{c(!0);const d=await fetch(`${s}/address/${r}`,{method:"DELETE",headers:{Authorization:`Bearer ${l}`}}),a=await d.json();return d.ok?(o.success((a==null?void 0:a.message)||"Address deleted successfully"),a==null?void 0:a.data):null}catch{return o.error("Unable to delete address, please try again later!"),null}finally{c(!1)}},loading:u}},z=()=>{const u=_(),c=S(d=>{var a;return(a=d==null?void 0:d.auth)==null?void 0:a.isAuthenticated}),[s,l]=g.useState(!0),h="http://35.154.167.170:3000",r=localStorage.getItem("token");return g.useEffect(()=>{if(!c||!r){l(!1);return}(async()=>{var a;try{const m=await fetch(`${h}/address`,{method:"GET",headers:{Authorization:`Bearer ${r}`}}),t=await m.json();m.ok?u($((a=t==null?void 0:t.data)==null?void 0:a.result)):o.error("Failed to fetch address data!")}catch{o.error("Failed to fetch address data!")}finally{l(!1)}})()},[c,h,u,r]),{loading:s}};export{U as A,T as a,z as u};
