import{_ as p,b as D,r as o,j as e,a1 as S,c as I}from"./index-BkRZouuw.js";import{L}from"./Loading-DOOB_kV0.js";const A=()=>{const c="http://3.110.208.70:3000",d=localStorage.getItem("token");return{getUserDetail:async()=>{try{const t=await fetch(`${c}/user/customer`,{method:"GET",headers:{Authorization:`Bearer ${d}`}}),s=await t.json();if(t.ok)return s.data;p.error("Unable to retrieve user details. Please try again later.",{className:"toast-error"})}catch{p.error("Failed to fetch user information. Please check your connection.",{className:"toast-error"})}}}},E=()=>{const c="http://3.110.208.70:3000",d=localStorage.getItem("token");return{updateUserDetail:async t=>{var m,f;let s=new FormData;s.append("first_name",t.first_name),s.append("last_name",t.last_name),s.append("email",t.email),s.append("mobile_number",t.mobile_number),s.append("gender",t.gender),t.image&&s.append("image",t.image),t.id_proof&&s.append("id_proof",t.id_proof);try{const g=await fetch(`${c}/user/customer`,{method:"PUT",headers:{Authorization:`Bearer ${d}`},body:s}),l=await g.json();return g.ok?(p.success("Your profile details have been successfully updated!",{className:"toast-success"}),(f=(m=l==null?void 0:l.data)==null?void 0:m.user)==null?void 0:f.updatedData):(p.error("Unable to update your profile at the moment. Please try again later.",{className:"toast-error"}),null)}catch{return p.error("Profile update failed! Please check the information and try again.",{className:"toast-error"}),null}}}},B=()=>{const c=D(),{getUserDetail:d}=A(),{updateUserDetail:x}=E(),[t,s]=o.useState(null),[m,f]=o.useState(null),[g,l]=o.useState(!1),[r,u]=o.useState({first_name:"",last_name:"",email:"",mobile_number:"",gender:0,id_proof:null,image:null}),[N,v]=o.useState(!0),y=async n=>{if(n.preventDefault(),g){const a=await x(r);a&&c(I(a))}},h=n=>{const{name:a,value:i}=n.target;a=="gender"?(l(!0),u({...r,[a]:Number(i)})):(l(!0),u({...r,[a]:i}))},_=n=>{let a=n.target.files[0];a&&(l(!0),u({...r,id_proof:a}))},U=n=>{let a=n.target.files[0];if(a){l(!0);const i=URL.createObjectURL(a);s(i),u({...r,image:a})}};return o.useEffect(()=>{(async()=>{const a=await d();if(a){const{first_name:i,last_name:w,email:F,mobile_number:k,gender:P,image:b,id_proof:j}=a.user;u({first_name:i,last_name:w,email:F,mobile_number:k,gender:P});const C=b||"/default_pfp.png";j&&f(j),s(C),v(!1)}})()},[]),N?e.jsx(L,{}):e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"dash-section-head mb-5",children:"Customer Master - Details"}),e.jsx("div",{className:"cus-detail-container",children:e.jsxs("div",{className:"p-14 flex items-start gap-20",children:[e.jsxs("div",{className:"profile-img-container relative",children:[e.jsx("img",{src:t,alt:"Avatar",className:"h-full w-full rounded-full border-[1.5px] border-[var(--black)]"}),e.jsx("button",{className:"edit-profile-img",onClick:()=>document.getElementById("profileImageInput").click(),children:e.jsx(S,{className:"inline-block h-full w-full fill-white p-3"})}),e.jsx("input",{type:"file",id:"profileImageInput",className:"hidden",accept:"image/*",onChange:U})]}),e.jsx("div",{className:"grow",children:e.jsx("form",{className:"user-detail",onSubmit:y,children:e.jsxs("div",{className:"grid grid-cols-2 gap-x-12 gap-y-14",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("label",{htmlFor:"firstname",children:"first name"}),e.jsx("input",{id:"firstname",type:"text",name:"first_name",value:r.first_name,onChange:h,className:"border-[1.5px] border-indigo-200 focus:border-indigo-500 focus:outline-none"})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("label",{htmlFor:"lastname",children:"last name"}),e.jsx("input",{id:"lastname",type:"text",name:"last_name",value:r.last_name,onChange:h,className:"border-[1.5px] border-indigo-200 focus:border-indigo-500 focus:outline-none"})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("label",{htmlFor:"email",children:"email"}),e.jsx("input",{readOnly:!0,id:"email",type:"text",name:"email",value:r.email,className:"readonly-input border-[1.5px] border-indigo-200 focus:border-indigo-500 focus:outline-none"})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("label",{htmlFor:"mobile",children:"mobile"}),e.jsx("input",{readOnly:!0,id:"mobile",type:"text",name:"mobile_number",value:r.mobile_number,className:"readonly-input border-[1.5px] border-indigo-200 focus:border-indigo-500 focus:outline-none"})]}),e.jsxs("div",{className:"col-span-2 flex flex-col gap-4",children:[e.jsx("label",{htmlFor:"document",children:"Update/Add document"}),e.jsx("input",{id:"document",type:"file",onChange:_,className:"border-[1.5px] border-indigo-200 focus:border-indigo-500 focus:outline-none"}),m&&e.jsx("div",{className:"flex items-start gap-8",children:e.jsx("a",{href:m,className:"inline-block text-indigo-600 hover:underline",target:"__blank",children:"view document"})})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("label",{htmlFor:"gender",children:"gender"}),e.jsxs("div",{className:"grow flex items-stretch justify-stretch gap-8",children:[e.jsxs("label",{htmlFor:"male",className:"flex items-center justify-center gap-2 border border-indigo-300 py-[1.25rem] rounded-lg px-4",children:[e.jsx("input",{id:"male",type:"radio",name:"gender",value:1,onChange:h,checked:r.gender==1}),e.jsx("span",{className:"text-[1.5rem] leading-[1.7rem] text-[var(--black)]",children:"Male"})]}),e.jsxs("label",{htmlFor:"female",className:"flex items-center justify-center gap-2 border border-indigo-300 py-[1.25rem] rounded-lg px-4",children:[e.jsx("input",{id:"female",type:"radio",name:"gender",value:2,onChange:h,checked:r.gender==2}),e.jsx("span",{className:"text-[1.5rem] leading-[1.7rem] text-[var(--black)]",children:"Female"})]})]})]}),e.jsx("div",{className:"col-span-2",children:e.jsx("button",{className:"update-btn",type:"submit",children:"update"})})]})})})]})})]})};export{B as default};
